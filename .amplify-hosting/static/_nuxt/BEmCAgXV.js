const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CL2yjAnz.js","./D59wPe2Q.js"])))=>i.map(i=>d[i]);
import{r as i,e as A,u as R,f as j,w as F,_ as b,o as u,a as e,c as x,k as L,d as C,t as r,F as D,g as G,m as T,j as q,l as d,v,G as E}from"#entry";import{_ as O}from"./Dyv7dZ9s.js";const I={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-8"},$={class:"mt-4 sm:mt-0"},H={class:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6"},K={class:"bg-white p-4 rounded-lg shadow-sm border border-gray-200"},Y={class:"flex items-center"},J={class:"ml-3"},Q={class:"text-xl font-semibold text-gray-900"},W={class:"bg-white p-4 rounded-lg shadow-sm border border-gray-200"},X={class:"flex items-center"},Z={class:"ml-3"},ee={class:"text-xl font-semibold text-gray-900"},te={class:"bg-white p-4 rounded-lg shadow-sm border border-gray-200"},se={class:"flex items-center"},oe={class:"ml-3"},ae={class:"text-xl font-semibold text-gray-900"},re={class:"bg-white p-4 rounded-lg shadow-sm border border-gray-200"},le={class:"flex items-center"},ne={class:"ml-3"},ie={class:"text-xl font-semibold text-gray-900"},de={class:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden"},ue={key:0,class:"p-8 text-center"},ce={key:1,class:"p-8 text-center"},me={key:2,class:"overflow-x-auto"},pe={class:"min-w-full divide-y divide-gray-200"},xe={class:"bg-white divide-y divide-gray-200"},ve={class:"px-6 py-4 whitespace-nowrap"},ge={class:"flex items-center"},fe={class:"flex-shrink-0 h-10 w-10"},be={class:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center"},ye={class:"text-sm font-medium text-blue-600"},we={class:"ml-4"},he={class:"text-sm font-medium text-gray-900"},_e={class:"text-sm text-gray-500"},ke={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Ce={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Ee={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Be={class:"px-6 py-4 whitespace-nowrap"},Se={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},Ve=["onClick"],Me=["onClick"],Ne={key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},Pe={class:"relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white"},ze={class:"mt-3"},Ue={class:"text-lg font-medium text-gray-900 mb-4"},Ae={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Re={class:"flex justify-end space-x-3 pt-4"},je=["disabled"],Ge={__name:"index",setup(Fe){const g=i([]),w=i(!0),c=i(!1),m=i(!1),h=i(!1),_=i(null),p=i({total:0,verified:0,pending:0,avgBalance:0}),a=i({firstName:"",lastName:"",email:"",username:"",CountryBirthday:"",Gender:"",birthday:"",Balance:0,kyc_status:"verified",kyc_level:"basic"}),B=(o,t)=>{const l=o?o.charAt(0).toUpperCase():"",s=t?t.charAt(0).toUpperCase():"";return l+s||"N/A"},S=o=>"bg-green-100 text-green-800",y=async()=>{try{w.value=!0;const{useSupabase:o}=await b(async()=>{const{useSupabase:f}=await import("./CL2yjAnz.js");return{useSupabase:f}},__vite__mapDeps([0,1]),import.meta.url),t=o(),{data:l,error:s,count:n}=await t.from("USERS").select("*",{count:"exact"}).limit(50);if(s){console.error("Error loading contacts:",s),g.value=[];return}g.value=l||[],await V()}catch(o){console.error("Error:",o),g.value=[]}finally{w.value=!1}},V=async()=>{try{const{useSupabase:o}=await b(async()=>{const{useSupabase:f}=await import("./CL2yjAnz.js");return{useSupabase:f}},__vite__mapDeps([0,1]),import.meta.url),t=o(),{count:l}=await t.from("USERS").select("*",{count:"exact",head:!0}),{data:s}=await t.from("USERS").select("Balance").not("Balance","is",null),n=s&&s.length>0?s.reduce((f,U)=>f+parseFloat(U.Balance||0),0)/s.length:0;p.value={total:l||0,verified:l||0,pending:0,avgBalance:n}}catch(o){console.error("Error loading stats:",o),p.value={total:0,verified:0,pending:0,avgBalance:0}}},M=async()=>{try{c.value=!0;const{useSupabase:o}=await b(async()=>{const{useSupabase:n}=await import("./CL2yjAnz.js");return{useSupabase:n}},__vite__mapDeps([0,1]),import.meta.url),t=o();a.value.kyc_status="verified";const{data:l,error:s}=await t.from("USERS").insert([a.value]);if(s){console.error("Error adding contact:",s),alert("Error al crear el contacto: "+s.message);return}alert("Contacto creado exitosamente"),k(),y()}catch(o){console.error("Error:",o),alert("Error al crear el contacto")}finally{c.value=!1}},N=o=>{_.value=o,a.value={...o},h.value=!0},P=async()=>{try{c.value=!0;const{useSupabase:o}=await b(async()=>{const{useSupabase:n}=await import("./CL2yjAnz.js");return{useSupabase:n}},__vite__mapDeps([0,1]),import.meta.url),t=o();a.value.kyc_status="verified";const{data:l,error:s}=await t.from("USERS").update(a.value).eq("idPerson",_.value.idPerson);if(s){console.error("Error updating contact:",s),alert("Error al actualizar el contacto: "+s.message);return}alert("Contacto actualizado exitosamente"),k(),y()}catch(o){console.error("Error:",o),alert("Error al actualizar el contacto")}finally{c.value=!1}},z=async o=>{if(confirm("¿Estás seguro de que quieres eliminar este contacto?"))try{const{useSupabase:t}=await b(async()=>{const{useSupabase:n}=await import("./CL2yjAnz.js");return{useSupabase:n}},__vite__mapDeps([0,1]),import.meta.url),l=t(),{error:s}=await l.from("USERS").delete().eq("idPerson",o.idPerson);if(s){console.error("Error deleting contact:",s),alert("Error al eliminar el contacto: "+s.message);return}alert("Contacto eliminado exitosamente"),y()}catch(t){console.error("Error:",t),alert("Error al eliminar el contacto")}},k=()=>{m.value=!1,h.value=!1,_.value=null,a.value={firstName:"",lastName:"",email:"",username:"",CountryBirthday:"",Gender:"",birthday:"",Balance:0,kyc_status:"verified",kyc_level:"basic"}};return A(()=>{y()}),R({title:"Contactos - MailPower"}),(o,t)=>{const l=O;return u(),j(l,{name:"default"},{default:F(()=>[e("div",null,[e("div",I,[t[11]||(t[11]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900"},"Contactos"),e("p",{class:"mt-2 text-gray-600"},"Gestiona tu base de datos de usuarios y contactos")],-1)),e("div",$,[e("button",{onClick:t[0]||(t[0]=s=>m.value=!0),class:"inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 transition-colors"},[...t[10]||(t[10]=[e("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),C(" Nuevo Contacto ",-1)])])])]),e("div",H,[e("div",K,[e("div",Y,[t[13]||(t[13]=e("div",{class:"p-2 bg-blue-100 rounded-lg"},[e("svg",{class:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})])],-1)),e("div",J,[t[12]||(t[12]=e("p",{class:"text-sm font-medium text-gray-600"},"Total",-1)),e("p",Q,r(p.value.total),1)])])]),e("div",W,[e("div",X,[t[15]||(t[15]=e("div",{class:"p-2 bg-green-100 rounded-lg"},[e("svg",{class:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("div",Z,[t[14]||(t[14]=e("p",{class:"text-sm font-medium text-gray-600"},"Verificados",-1)),e("p",ee,r(p.value.verified),1)])])]),e("div",te,[e("div",se,[t[17]||(t[17]=e("div",{class:"p-2 bg-yellow-100 rounded-lg"},[e("svg",{class:"w-5 h-5 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})])],-1)),e("div",oe,[t[16]||(t[16]=e("p",{class:"text-sm font-medium text-gray-600"},"Pendientes",-1)),e("p",ae,r(p.value.pending),1)])])]),e("div",re,[e("div",le,[t[19]||(t[19]=e("div",{class:"p-2 bg-purple-100 rounded-lg"},[e("svg",{class:"w-5 h-5 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})])],-1)),e("div",ne,[t[18]||(t[18]=e("p",{class:"text-sm font-medium text-gray-600"},"Balance Promedio",-1)),e("p",ie,"$"+r(p.value.avgBalance.toFixed(2)),1)])])])]),e("div",de,[w.value?(u(),x("div",ue,[...t[20]||(t[20]=[e("div",{class:"inline-flex items-center px-4 py-2 text-sm text-gray-600"},[e("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-gray-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]),C(" Cargando contactos... ")],-1)])])):g.value.length===0?(u(),x("div",ce,[...t[21]||(t[21]=[e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})],-1),e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"Sin contactos",-1),e("p",{class:"mt-1 text-sm text-gray-500"},"Agrega tu primer contacto para comenzar",-1)])])):(u(),x("div",me,[e("table",pe,[t[22]||(t[22]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Contacto"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Email"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"País"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Balance"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"KYC"),e("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Acciones")])],-1)),e("tbody",xe,[(u(!0),x(D,null,G(g.value,s=>(u(),x("tr",{key:s.idPerson,class:"hover:bg-gray-50"},[e("td",ve,[e("div",ge,[e("div",fe,[e("div",be,[e("span",ye,r(B(s.firstName,s.lastName)),1)])]),e("div",we,[e("div",he,r(s.firstName)+" "+r(s.lastName),1),e("div",_e,r(s.username),1)])])]),e("td",ke,r(s.email),1),e("td",Ce,r(s.CountryBirthday),1),e("td",Ee," $"+r(parseFloat(s.Balance||0).toFixed(2)),1),e("td",Be,[e("span",{class:T(["inline-flex px-2 py-1 text-xs font-semibold rounded-full",S(s.kyc_status)])},r(s.kyc_status||"verified"),3)]),e("td",Se,[e("button",{onClick:n=>N(s),class:"text-blue-600 hover:text-blue-900 mr-3"}," Editar ",8,Ve),e("button",{onClick:n=>z(s),class:"text-red-600 hover:text-red-900"}," Eliminar ",8,Me)])]))),128))])])]))])]),m.value||h.value?(u(),x("div",Ne,[e("div",Pe,[e("div",ze,[e("h3",Ue,r(m.value?"Nuevo Contacto":"Editar Contacto"),1),e("form",{onSubmit:t[9]||(t[9]=q(s=>m.value?M():P(),["prevent"])),class:"space-y-4"},[e("div",Ae,[e("div",null,[t[23]||(t[23]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Nombre",-1)),d(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>a.value.firstName=s),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[v,a.value.firstName]])]),e("div",null,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Apellido",-1)),d(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>a.value.lastName=s),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[v,a.value.lastName]])]),e("div",null,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Email",-1)),d(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>a.value.email=s),type:"email",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[v,a.value.email]])]),e("div",null,[t[26]||(t[26]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Username",-1)),d(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>a.value.username=s),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[v,a.value.username]])]),e("div",null,[t[28]||(t[28]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"País",-1)),d(e("select",{"onUpdate:modelValue":t[5]||(t[5]=s=>a.value.CountryBirthday=s),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},[...t[27]||(t[27]=[e("option",{value:""},"Seleccionar país",-1),e("option",{value:"Colombia"},"Colombia",-1),e("option",{value:"Venezuela"},"Venezuela",-1),e("option",{value:"Ecuador"},"Ecuador",-1),e("option",{value:"Peru"},"Perú",-1)])],512),[[E,a.value.CountryBirthday]])]),e("div",null,[t[30]||(t[30]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Género",-1)),d(e("select",{"onUpdate:modelValue":t[6]||(t[6]=s=>a.value.Gender=s),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},[...t[29]||(t[29]=[e("option",{value:""},"Seleccionar género",-1),e("option",{value:"M"},"Masculino",-1),e("option",{value:"F"},"Femenino",-1),e("option",{value:"Other"},"Otro",-1)])],512),[[E,a.value.Gender]])]),e("div",null,[t[31]||(t[31]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Balance",-1)),d(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>a.value.Balance=s),type:"number",step:"0.01",min:"0",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[v,a.value.Balance]])]),e("div",null,[t[32]||(t[32]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Fecha de Nacimiento",-1)),d(e("input",{"onUpdate:modelValue":t[8]||(t[8]=s=>a.value.birthday=s),type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[v,a.value.birthday]])])]),e("div",Re,[e("button",{type:"button",onClick:k,class:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md"}," Cancelar "),e("button",{type:"submit",disabled:c.value,class:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md disabled:opacity-50"},r(c.value?"Guardando...":m.value?"Crear":"Actualizar"),9,je)])],32)])])])):L("",!0)]),_:1})}}};export{Ge as default};
