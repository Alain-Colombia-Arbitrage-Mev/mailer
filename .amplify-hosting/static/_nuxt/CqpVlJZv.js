import{a1 as r,n as s}from"#entry";const d=r((i,t)=>{try{console.log("🔍 Simple-auth middleware ejecutándose para:",i.path);const o=localStorage.getItem("admin_session");if(console.log("📦 Datos en localStorage:",o?"Encontrados":"No encontrados"),!o)return console.log("🚫 No hay sesión, redirigiendo a login..."),s("/auth/simple-login");const e=JSON.parse(o);console.log("👤 Datos de sesión:",{hasUser:!!e.user,userEmail:e.user?.email,isAdmin:e.user?.isAdmin,timestamp:e.timestamp,age:Date.now()-(e.timestamp||0)});const n=Date.now()-(e.timestamp||0),a=1440*60*1e3;if(n>a)return console.log("🕒 Sesión expirada, eliminando y redirigiendo..."),localStorage.removeItem("admin_session"),s("/auth/simple-login");if(!e.user||!e.user.isAdmin)return console.log("🚫 Usuario no admin, redirigiendo a login...",{hasUser:!!e.user,isAdmin:e.user?.isAdmin}),s("/auth/simple-login");console.log("✅ Usuario autenticado, permitiendo acceso a:",i.path)}catch(o){return console.error("❌ Error verificando autenticación:",o),localStorage.removeItem("admin_session"),s("/auth/simple-login")}});export{d as default};
