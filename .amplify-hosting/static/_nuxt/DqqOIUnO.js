import{q as R,r as x,e as P,c as a,a as o,k as g,s,t as n,d,J as y,F as h,g as C,l as S,v as E,o as l}from"#entry";const T={style:{"min-height":"100vh",background:"#f9fafb",padding:"20px","font-family":"monospace"}},M={style:{"max-width":"800px",margin:"0 auto"}},N={style:{background:"white",padding:"30px","border-radius":"12px","box-shadow":"0 4px 6px -1px rgba(0, 0, 0, 0.1)","margin-bottom":"20px"}},z=["disabled"],j={key:0,style:{"margin-top":"20px"}},O={style:{background:"#f3f4f6",padding:"15px","border-radius":"8px","margin-bottom":"15px"}},F={style:{background:"#f3f4f6",padding:"15px","border-radius":"8px","margin-bottom":"15px"}},A={style:{background:"#f3f4f6",padding:"15px","border-radius":"8px","margin-bottom":"15px"}},J={key:0},U={style:{background:"#f3f4f6",padding:"15px","border-radius":"8px","margin-bottom":"15px"}},$={key:0},I={key:0,style:{background:"#f3f4f6",padding:"15px","border-radius":"8px","margin-bottom":"15px"}},G={key:0},q={key:1,style:{background:"#fef2f2",border:"1px solid #fecaca",padding:"15px","border-radius":"8px"}},H={style:{"margin-top":"30px","padding-top":"20px","border-top":"1px solid #e5e7eb"}},K={style:{display:"grid","grid-template-columns":"1fr 1fr",gap:"15px","margin-bottom":"15px"}},Q={style:{display:"flex",gap:"10px","margin-bottom":"15px"}},W=["disabled"],X=["disabled"],Y={key:0},Z={key:1,style:{background:"#f3f4f6",padding:"10px","border-radius":"4px","font-size":"12px",overflow:"auto","margin-top":"10px"}},_={style:{"margin-top":"30px","padding-top":"20px","border-top":"1px solid #e5e7eb"}},oo={key:0,style:{background:"#f3f4f6",padding:"15px","border-radius":"8px","margin-bottom":"15px"}},eo={style:{background:"#ffffff",padding:"10px","border-radius":"4px","font-size":"12px",overflow:"auto"}},no=R({__name:"admin-login",setup(so){const r=x(null),i=x(null),m=x(null),c=x(!1),b=x(!1),u=x({email:"info@be-mindpower.net",password:"Be-mind.2025+++"}),w=async()=>{c.value=!0;try{const t=await $fetch("/api/debug/admin-login-debug");r.value=t}catch(t){console.error("Error ejecutando diagn√≥stico:",t),r.value={success:!1,error:"No se pudo ejecutar el diagn√≥stico"}}finally{c.value=!1}},B=async()=>{b.value=!0,i.value=null;try{const t=await $fetch("/api/auth/admin-login-bypass",{method:"POST",body:{email:u.value.email,password:u.value.password}});i.value={success:!0,...t,fullResponse:t}}catch(t){console.error("Error en bypass login:",t),i.value={success:!1,error:t.data?.statusMessage||t.statusMessage||t.message||"Error desconocido",fullResponse:t}}finally{b.value=!1}},D=async()=>{b.value=!0,i.value=null;try{const t=await $fetch("/api/auth/admin-login",{method:"POST",body:{email:u.value.email,password:u.value.password}});i.value={success:!0,...t,fullResponse:t}}catch(t){console.error("Error en Supabase login:",t),i.value={success:!1,error:t.data?.statusMessage||t.statusMessage||t.message||"Error desconocido",fullResponse:t}}finally{b.value=!1}},L=()=>{u.value.email="info@be-mindpower.net",u.value.password="Be-mind.2025+++"},v=()=>{{const t=localStorage.getItem("admin_bypass_session");if(t)try{const e=JSON.parse(t),p=new Date(e.timestamp),k=(new Date().getTime()-p.getTime())/(1e3*60*60);m.value={exists:!0,valid:k<8,hoursElapsed:k.toFixed(2),data:e}}catch{m.value={exists:!0,valid:!1,error:"Error parseando sesi√≥n",rawData:t}}else m.value={exists:!1,message:"No hay sesi√≥n bypass en localStorage"}}},V=()=>{localStorage.removeItem("admin_bypass_session"),m.value={cleared:!0,message:"Sesi√≥n bypass eliminada exitosamente"},setTimeout(()=>{v()},500)};return P(()=>{w(),v()}),(t,e)=>(l(),a("div",T,[o("div",M,[o("div",N,[e[29]||(e[29]=o("h1",{style:{"font-size":"24px","font-weight":"bold","margin-bottom":"20px",color:"#1f2937"}},"üîß Diagn√≥stico del Sistema de Login Admin",-1)),o("button",{onClick:w,disabled:s(c),style:{background:"#3b82f6",color:"white",border:"none","border-radius":"8px",padding:"12px 24px",cursor:"pointer","margin-bottom":"20px","font-weight":"500"}},n(s(c)?"Ejecutando diagn√≥stico...":"Ejecutar Diagn√≥stico"),9,z),s(r)?(l(),a("div",j,[e[19]||(e[19]=o("h2",{style:{"font-size":"18px","font-weight":"bold","margin-bottom":"15px",color:"#374151"}},"Resultado del Diagn√≥stico",-1)),o("div",O,[e[6]||(e[6]=o("h3",{style:{"font-weight":"bold","margin-bottom":"10px",color:"#111827"}},"üìä Estado General",-1)),o("p",null,[e[2]||(e[2]=o("strong",null,"Fecha:",-1)),d(" "+n(s(r).debug?.timestamp),1)]),o("p",null,[e[3]||(e[3]=o("strong",null,"Entorno:",-1)),d(" "+n(s(r).debug?.environment),1)]),o("p",null,[e[4]||(e[4]=o("strong",null,"Estado:",-1)),e[5]||(e[5]=d()),o("span",{style:y({color:s(r).success?"#059669":"#dc2626"})},n(s(r).success?"‚úì OK":"‚úó Error"),5)])]),o("div",F,[e[11]||(e[11]=o("h3",{style:{"font-weight":"bold","margin-bottom":"10px",color:"#111827"}},"üîë Credenciales de Admin",-1)),o("p",null,[e[7]||(e[7]=o("strong",null,"Email:",-1)),d(" "+n(s(r).debug?.adminCredentials?.email),1)]),o("p",null,[e[8]||(e[8]=o("strong",null,"Contrase√±a:",-1)),d(" "+n(s(r).debug?.adminCredentials?.password),1)]),o("p",null,[e[9]||(e[9]=o("strong",null,"Email configurado:",-1)),d(" "+n(s(r).debug?.adminCredentials?.emailValue),1)]),o("p",null,[e[10]||(e[10]=o("strong",null,"Longitud contrase√±a:",-1)),d(" "+n(s(r).debug?.adminCredentials?.passwordLength)+" caracteres",1)])]),o("div",A,[e[12]||(e[12]=o("h3",{style:{"font-weight":"bold","margin-bottom":"10px",color:"#111827"}},"üåç Variables de Entorno",-1)),s(r).debug?.environmentVariables?(l(),a("div",J,[(l(!0),a(h,null,C(s(r).debug.environmentVariables,(p,f)=>(l(),a("p",{key:f},[o("strong",null,n(f)+":",1),o("span",{style:y({color:p.includes("‚úì")?"#059669":"#dc2626"})},n(p),5)]))),128))])):g("",!0)]),o("div",U,[e[13]||(e[13]=o("h3",{style:{"font-weight":"bold","margin-bottom":"10px",color:"#111827"}},"üóÑÔ∏è Configuraci√≥n de Supabase",-1)),s(r).debug?.supabaseConfig?(l(),a("div",$,[(l(!0),a(h,null,C(s(r).debug.supabaseConfig,(p,f)=>(l(),a("p",{key:f},[o("strong",null,n(f)+":",1),o("span",{style:y({color:p.includes("‚úì")?"#059669":"#dc2626"})},n(p),5)]))),128))])):g("",!0)]),s(r).debug?.supabaseConnection?(l(),a("div",I,[e[16]||(e[16]=o("h3",{style:{"font-weight":"bold","margin-bottom":"10px",color:"#111827"}},"üîå Conexi√≥n de Supabase",-1)),o("p",null,[e[14]||(e[14]=o("strong",null,"Estado:",-1)),o("span",{style:y({color:s(r).debug.supabaseConnection.status.includes("‚úì")?"#059669":"#dc2626"})},n(s(r).debug.supabaseConnection.status),5)]),s(r).debug.supabaseConnection.error?(l(),a("p",G,[e[15]||(e[15]=o("strong",null,"Error:",-1)),d(" "+n(s(r).debug.supabaseConnection.error),1)])):g("",!0)])):g("",!0),s(r).success?g("",!0):(l(),a("div",q,[e[18]||(e[18]=o("h3",{style:{"font-weight":"bold","margin-bottom":"10px",color:"#991b1b"}},"‚ùå Error",-1)),o("p",null,[e[17]||(e[17]=o("strong",null,"Mensaje:",-1)),d(" "+n(s(r).error),1)])]))])):g("",!0),o("div",H,[e[26]||(e[26]=o("h2",{style:{"font-size":"18px","font-weight":"bold","margin-bottom":"15px",color:"#374151"}},"üß™ Prueba de Login",-1)),o("div",K,[o("div",null,[e[20]||(e[20]=o("label",{style:{display:"block","font-weight":"500","margin-bottom":"5px"}},"Email:",-1)),S(o("input",{"onUpdate:modelValue":e[0]||(e[0]=p=>s(u).email=p),type:"email",style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db","border-radius":"6px"},placeholder:"info@be-mindpower.net"},null,512),[[E,s(u).email]])]),o("div",null,[e[21]||(e[21]=o("label",{style:{display:"block","font-weight":"500","margin-bottom":"5px"}},"Contrase√±a:",-1)),S(o("input",{"onUpdate:modelValue":e[1]||(e[1]=p=>s(u).password=p),type:"password",style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db","border-radius":"6px"},placeholder:"Be-mind.2025+++"},null,512),[[E,s(u).password]])])]),o("div",Q,[o("button",{onClick:B,disabled:s(b),style:{background:"#10b981",color:"white",border:"none","border-radius":"6px",padding:"10px 20px",cursor:"pointer","font-weight":"500"}},n(s(b)?"Probando...":"Probar Bypass Login"),9,W),o("button",{onClick:D,disabled:s(b),style:{background:"#8b5cf6",color:"white",border:"none","border-radius":"6px",padding:"10px 20px",cursor:"pointer","font-weight":"500"}},n(s(b)?"Probando...":"Probar Supabase Login"),9,X),o("button",{onClick:L,style:{background:"#6b7280",color:"white",border:"none","border-radius":"6px",padding:"10px 20px",cursor:"pointer","font-weight":"500"}}," Usar Credenciales por Defecto ")]),s(i)?(l(),a("div",{key:0,style:y([{padding:"15px","border-radius":"8px","margin-top":"15px"},{background:s(i).success?"#f0fdf4":"#fef2f2",border:`1px solid ${s(i).success?"#bbf7d0":"#fecaca"}`}])},[o("h4",{style:y([{"font-weight":"bold","margin-bottom":"8px"},{color:s(i).success?"#166534":"#991b1b"}])},n(s(i).success?"‚úÖ Prueba Exitosa":"‚ùå Prueba Fallida"),5),o("p",null,[e[22]||(e[22]=o("strong",null,"Mensaje:",-1)),d(" "+n(s(i).message||s(i).error),1)]),s(i).user?(l(),a("div",Y,[o("p",null,[e[23]||(e[23]=o("strong",null,"Usuario:",-1)),d(" "+n(s(i).user.email),1)]),o("p",null,[e[24]||(e[24]=o("strong",null,"Rol:",-1)),d(" "+n(s(i).user.role),1)]),o("p",null,[e[25]||(e[25]=o("strong",null,"Admin:",-1)),d(" "+n(s(i).user.isAdmin),1)])])):g("",!0),s(i).fullResponse?(l(),a("pre",Z,n(JSON.stringify(s(i).fullResponse,null,2)),1)):g("",!0)],4)):g("",!0)]),o("div",_,[e[28]||(e[28]=o("h2",{style:{"font-size":"18px","font-weight":"bold","margin-bottom":"15px",color:"#374151"}},"üîß Gesti√≥n de Sesiones Bypass",-1)),o("div",{style:{display:"flex",gap:"10px","margin-bottom":"15px"}},[o("button",{onClick:v,style:{background:"#6366f1",color:"white",border:"none","border-radius":"6px",padding:"10px 20px",cursor:"pointer","font-weight":"500"}}," Verificar Sesi√≥n Bypass "),o("button",{onClick:V,style:{background:"#dc2626",color:"white",border:"none","border-radius":"6px",padding:"10px 20px",cursor:"pointer","font-weight":"500"}}," Limpiar Sesi√≥n Bypass ")]),s(m)?(l(),a("div",oo,[e[27]||(e[27]=o("h4",{style:{"font-weight":"bold","margin-bottom":"8px",color:"#111827"}},"üìù Estado de Sesi√≥n Bypass",-1)),o("pre",eo,n(JSON.stringify(s(m),null,2)),1)])):g("",!0)]),e[30]||(e[30]=o("div",{style:{"text-align":"center","margin-top":"30px","padding-top":"20px","border-top":"1px solid #e5e7eb"}},[o("a",{href:"/auth/admin-login",style:{color:"#3b82f6","text-decoration":"none","margin-right":"20px"}},"‚Üê Volver al Login"),o("a",{href:"/dashboard",style:{color:"#3b82f6","text-decoration":"none"}},"Dashboard ‚Üí")],-1))])])]))}});export{no as default};
